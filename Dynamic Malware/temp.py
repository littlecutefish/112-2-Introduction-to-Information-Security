from pptx import Presentation
from docx import Document
from docx.shared import Inches
import os


def ppt_to_pdf(input_ppt, output_pdf):
    prs = Presentation(input_ppt)
    pdf_document = Document()

    for slide in prs.slides:
        for shape in slide.shapes:
            if hasattr(shape, "text"):
                text = shape.text
                pdf_document.add_paragraph(text)

    pdf_document.save(output_pdf)


def convert_all_ppt_to_pdf(input_folder, output_folder):
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    ppt_files = [f for f in os.listdir(input_folder) if f.endswith(".pptx")]

    for ppt_file in ppt_files:
        ppt_path = os.path.join(input_folder, ppt_file)
        pdf_path = os.path.join(output_folder, os.path.splitext(ppt_file)[0] + ".pdf")
        ppt_to_pdf(ppt_path, pdf_path)


# 将PPT文件夹中的所有PPT转换为PDF
convert_all_ppt_to_pdf("input_folder", "output_folder")
